(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{430:function(e,t,n){"use strict";n.r(t);var r=n(118),l=n.n(r),d={inject:["showLoginDialog"],data:function(){return{search:"",dataLoading:!0,dialog:!1,headers:[{text:"Order ID",align:"center",value:"order_id"},{text:"Passenger",value:"passenger_name",sortable:!1,align:"center"},{text:"Train No",value:"train_num",sortable:!1,align:"center"},{text:"Departure Station",value:"dep_station",sortable:!1,align:"center"},{text:"Arrival Station",value:"arr_station",sortable:!1,align:"center"},{text:"Departure Time",value:"dep_time",sortable:!0,align:"center"},{text:"Price",value:"seat_price",sortable:!1,align:"center"},{text:"Actions",value:"actions",sortable:!1,align:"center"}],desserts:[],editedIndex:-1,editedItem:{order_id:0,passenger_name:null,train_num:null,dep_station:null,arr_station:null,seat_no:null,seat_price:null,seat_type:null,purchase_time:null,dep_time:null,arr_time:null,passenger_idcard:null},defaultItem:{order_id:0,passenger_name:null,train_num:null,dep_station:null,arr_station:null,seat_no:null,seat_price:null,seat_type:null,purchase_time:null,dep_time:null,arr_time:null,passenger_idcard:null},allowRefund:15e5}},computed:{formTitle:function(){return-1===this.editedIndex?"New Item":"Edit Item"}},watch:{dialog:function(e){e||this.close()}},mounted:function(){this.initialize()},methods:{initialize:function(){var e=this;l.a.get("/api/orderlist").then((function(t){e.desserts=t.data.result,e.dataLoading=!1})).catch((function(t){401===t.response.status&&e.showLoginDialog()}))},moreInfo:function(e){this.dialog=!0,this.editedItem=e},close:function(){var e=this;this.dialog=!1,this.$nextTick((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}))},canRefund:function(){var e=new Date;return this.editedItem.dep_time.substr(0,10)===e.toISOString().substr(0,10)?new Date(this.editedItem.dep_time)-e>this.allowRefund:!(this.editedItem.dep_time.substr(0,10)<e.toISOString().substr(0,10))},refund:function(){var e=this,t=this.desserts.indexOf(this.editedItem);if(this.canRefund()){if(confirm("Are you sure you want to refund this ticket?")){var n="/api/refund?order_id="+this.editedItem.order_id;l.a.get(n).then((function(){e.desserts.splice(t,1)}))}this.dialog=!1}else alert("Error: You cannot refund the ticket because it is less than 25 minutes before the departure time")}}},o=n(72),c=n(99),_=n.n(c),m=n(338),v=n(156),f=n(141),h=n(80),I=n(425),x=n(342),w=n(359),k=n(140),y=n(360),V=n(346),D=n(328),T=n(38),C=n(131),component=Object(o.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-layout",[n("v-flex",{staticClass:"text-center"},[n("img",{staticClass:"mb-5",attrs:{src:"/v.png",alt:"Vuetify.js"}}),e._v(" "),n("blockquote",{staticClass:"blockquote"},[n("div",{attrs:{id:"app"}},[n("v-app",{attrs:{id:"inspire"}},[n("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.desserts,search:e.search,loading:e.dataLoading,"sort-by":"Order ID"},scopedSlots:e._u([{key:"top",fn:function(){return[n("v-toolbar",{attrs:{flat:"",color:"white"}},[n("v-toolbar-title",[e._v("Order List")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[e._v(" Details ")])]),e._v(" "),n("v-card-text",[e._v("\n                      Order ID: "+e._s(e.editedItem.order_id)+" "),n("br"),e._v("\n                      Passenger: "+e._s(e.editedItem.passenger_name)+" |\n                      "+e._s(e.editedItem.passenger_idcard)+" "),n("br"),e._v("\n                      Train ID: "+e._s(e.editedItem.train_num)+" "),n("br"),e._v("\n                      Interval: "+e._s(e.editedItem.dep_station)+" ->\n                      "+e._s(e.editedItem.arr_station)+" "),n("br"),e._v("\n                      Interval Time: "+e._s(e.editedItem.dep_time)+" ->\n                      "+e._s(e.editedItem.arr_time)+" "),n("br"),e._v("\n                      Seat: "+e._s(e.editedItem.seat_no)+" |\n                      "+e._s(e.editedItem.seat_type)+" "),n("br"),e._v("\n                      Price: "+e._s(e.editedItem.seat_price)+" "),n("br"),e._v("\n                      Purchase Time: "+e._s(e.editedItem.purchase_time)+" "),n("br")]),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"error",depressed:"",disabled:new Date(e.editedItem.dep_time)-new Date<e.allowRefund},on:{click:e.refund}},[e._v("Refund")]),e._v(" "),n("v-btn",{attrs:{color:"blue",depressed:""},on:{click:e.close}},[e._v("Close")])],1)],1)],1)],1)]},proxy:!0},{key:"item.actions",fn:function(t){var r=t.item;return[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.moreInfo(r)}}},[e._v("\n                mdi-dots-horizontal\n              ")])]}},{key:"no-data",fn:function(){return[n("v-btn",{attrs:{color:"primary"},on:{click:e.initialize}},[e._v("Reset")])]},proxy:!0}])})],1)],1)])])],1)}),[],!1,null,null,null);t.default=component.exports;_()(component,{VApp:m.a,VBtn:v.a,VCard:f.a,VCardActions:h.a,VCardText:h.b,VCardTitle:h.c,VDataTable:I.a,VDialog:x.a,VFlex:w.a,VIcon:k.a,VLayout:y.a,VSpacer:V.a,VTextField:D.a,VToolbar:T.a,VToolbarTitle:C.a})}}]);